'use strict';

(function (root) {

	function sliders() {
		// Параметры слайдеров
		var data = {
			tile: {
				arrows: false,
				dots: true,
				fade: true,
				autoplay: true,
				autoplaySpeed: 4000,
				pauseOnHover: false
			},
			recom: {
				slidesToShow: 4,
				prevArrow: $('.arrow_prev'),
				nextArrow: $('.arrow_next'),
				responsive: [{
					breakpoint: 1200,
					settings: {
						variableWidth: true
					}
				}, {
					breakpoint: 1000,
					settings: {
						slidesToShow: 3
					}
				}, {
					breakpoint: 768,
					settings: {
						slidesToShow: 2
					}
				}, {
					breakpoint: 500,
					settings: {
						slidesToShow: 1
					}
				}]
			}
		};

		// Активация слайдеров
		$('.slider').each(function (i, s) {
			var slider = $(s).data('slider');

			$(s).find('.slider__slides').slick(data[slider]);
		});
	}

	sliders();

	// Галерея
	$('.gallery__view').addClass('show');

	$('.gallery__items li').on('click', function (e) {
		e.preventDefault();

		$(this).parent().find('.active').removeClass('active');
		$(this).addClass('active');

		var src = $(this).data('view');

		$('.gallery__view').removeClass('show');

		setTimeout(function () {
			$('.gallery__view img').attr('src', src);
			$('.gallery__view').addClass('show');
		}, 300);

		$('.modal_view .modal__gallery img').attr('src', src);
	});

	$('.gallery__items li').first().trigger('click');

	if ($('.gallery__items').children().length <= 1) {
		$('.modal_view .modal__nav').hide();
	}

	// Табы
	$('.tabs li').on('click', function (e) {
		e.preventDefault();

		$(this).parent().find('.active').removeClass('active');
		$(this).addClass('active');

		$('[data-tab]').hide();

		var tab = $('[data-tab="' + $(this).index() + '"]').get(0);

		if (tab.tagName === 'FORM') {
			$(tab).css('display', 'flex');
		} else {
			$(tab).show();
		}
	});

	$('.tabs').each(function (i, tabs) {
		$(tabs).find('li').first().trigger('click');
	});

	// Боковое меню в каталоге
	$('.sidenav__item_drop > a').on('click', function (e) {
		e.preventDefault();

		$(this).parent().toggleClass('sidenav__item_show');
	});

	// Ползунок
	$('.range input').ionRangeSlider();

	// Радио
	function radioWork(radio) {
		var name = $(radio).attr('name');

		$('.radio input[name=' + name + ']').closest('.radio').removeClass('radio_active');
		$(radio).closest('.radio').addClass('radio_active');
	}

	$('.radio input:checked').each(function (i, radio) {
		radioWork(radio);
	});

	$('.radio').on('click', function () {
		var radio = $(this).find('input').get(0);

		radioWork(radio);
	});

	// Модалки

	$('[data-modal]').iziModal();

	$('.modal__nav, .modal__close').each(function (i, nav) {
		var modal = $(nav).closest('.modal');

		$(modal).append(nav);
	});

	$('[data-open]').on('click', function (e) {
		e.preventDefault();

		var m = $(this).data('open'),
		    modal = $('[data-modal="' + m + '"]'),
		    gallery = $(this).closest('.gallery');

		// превью

		if (m === 'view') {
			var img = $(this).find('img').clone();

			$(modal).find('.modal__gallery').html(img);
			$('.gallery__view').addClass('hidden');

			$('.modal__nav .arrow').on('click', function () {

				var active = $(gallery).find('.active');

				if ($(this).hasClass('arrow_prev')) {
					var prev = $(active).prev().get(0);

					if (!prev) {
						prev = $(gallery).find('.gallery__items').children().last();
					}

					$(active).removeClass('active');
					$(prev).trigger('click');
				} else {
					var next = $(active).next().get(0);

					if (!next) {
						next = $(gallery).find('.gallery__items').children().first();
					}

					$(active).removeClass('active');
					$(next).trigger('click');
				}
			});
		}

		$(modal).iziModal('open');

		$(document).on('closed', '[data-modal]', function (e) {
			$('.gallery__view.hidden').removeClass('hidden');
			$('.modal__nav .arrow').off();
		});
	});

	// Сетка

	setTimeout(function () {
		$('.grid').masonry({
			itemSelector: '.grid__item',
			gutter: 19,
			horizontalOrder: true
		});
	}, 100);

	// lookbook

	function lkActive(point) {
		var data = $(point).data('item'),
		    card = $(point).closest('.lookbook').find('.lookbook__list .card[data-item="' + data + '"]');

		$(point).siblings('.point').addClass('point_disable');
		$(card).removeClass('card_disable');
		$(card).siblings().addClass('card_disable');
	}

	function lkDisable(point) {
		$(point).siblings().removeClass('point_disable');
		$(point).closest('.lookbook').find('.card_disable').removeClass('card_disable');
	}

	$('.point').hover(function () {
		$(this).parent().find('.point_active').removeClass('point_active').siblings('.point_disable').removeClass('point_disable');
		lkActive(this);
	}, function () {
		if ($(this).hasClass('point_active')) {
			return;
		}
		lkDisable(this);
	});

	$('.point').on('click', function () {
		$(this).addClass('point_active');
		lkActive(this);
	});

	$('.lookbook__list .card').hover(function () {
		$(this).siblings().addClass('card_disable');
		var d = $(this).data('item');
		$('.point[data-item=' + d + ']').addClass('point_active');
	}, function () {
		$('.lookbook__list .card').removeClass('card_disable');
		$('.point_active').removeClass('point_active');
	});

	// Карточка адаптив

	function cardAdaptive() {
		var w = $(window).width();

		if (w <= 1000) {
			if (!$('.info_vertical').get(0)) {
				$(".info").unstick().removeClass('info_stick');
				$('.info').insertAfter('.gallery');
				$('.c-page__info').empty();
				$('.info').removeClass('info_horizontal').addClass('info_vertical');
			}
		} else {
			if (!$('.info_horizontal').get(0)) {
				$('.c-page__info').append($('.info'));
				$('.info').removeClass('info_vertical').addClass('info_horizontal');
			}
		}
	}

	cardAdaptive();
	$(window).on('resize', cardAdaptive);

	// Меню

	$('.menu').on('click', function (e) {
		e.preventDefault();

		$(this).closest('.header').toggleClass('header_show-menu');
	});

	// Город

	$('.city__current').on('click', function (e) {
		e.preventDefault();

		$('.city').toggleClass('city_show');
	});

	// lookbook editor

	function getCoords(elem) {
		return {
			top: elem.offsetTop,
			left: elem.offsetLeft
		};
	}

	var point = $('.point_move').get(0),
	    area = $('.lookbook__set img'),
	    areaBorders = {
		top: $(area).height() - 24,
		left: $(area).width() - 24
	};

	$(point).on('mousedown', function (e) {
		e.preventDefault();

		var coords = getCoords(point),
		    shiftX = e.pageX - coords.left,
		    shiftY = e.pageY - coords.top;

		moveAt(e);

		point.style.zIndex = 1000; // над другими элементами

		function moveAt(e) {
			var top = e.pageY - shiftY,
			    left = e.pageX - shiftX;

			if (left >= areaBorders.left) {
				left = areaBorders.left;
			} else if (left <= 0) {
				left = 0;
			}

			if (top <= 0) {
				top = 0;
			} else if (top >= areaBorders.top) {
				top = areaBorders.top;
			}

			point.style.left = left + 'px';
			point.style.top = top + 'px';

			$('[data-coords]').each(function (i, field) {
				var coords = $(this).data('coords'),
				    input = $(this).find('input');

				switch (coords) {
					case 'top':
						$(input).val(top);
						break;
					case 'left':
						$(input).val(left);
						break;
				}
			});
		}

		document.onmousemove = function (e) {
			moveAt(e);
		};

		point.onmouseup = function () {
			document.onmousemove = null;
			point.onmouseup = null;
		};

		point.ondragstart = function () {
			return false;
		};
	});

	// Инфо в карточке

	function infoStick() {
		if ($(window).width() > 1000) {
			if ($('.info').hasClass('info_stick')) {
				$('.info').sticky('update');
			} else {
				$('.info').sticky({
					topSpacing: 20,
					bottomSpacing: $('.page__wrapper').height() - $('.c-page__main').height() + $('.footer').height()
				}).addClass('info_stick');
			}
		}
	}

	$(window).on('resize', infoStick);
	infoStick();

	$('.c-page .tabs li').on('click', infoStick);

	$('.lk__item').on('click', function () {
		$('.lookbook__set').sticky();
	});

	$('.page__side-nav').on('click', function () {
		$(this).next('.sidenav').toggle();
	});

	$(window).on('scroll', function () {
		var s = 100 * $(window).scrollTop() / $('.page').height() * 1.8;

		$('.bg').css('top', -s + '%');
	});
})(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJyb290Iiwic2xpZGVycyIsImRhdGEiLCJ0aWxlIiwiYXJyb3dzIiwiZG90cyIsImZhZGUiLCJhdXRvcGxheSIsImF1dG9wbGF5U3BlZWQiLCJwYXVzZU9uSG92ZXIiLCJyZWNvbSIsInNsaWRlc1RvU2hvdyIsInByZXZBcnJvdyIsIiQiLCJuZXh0QXJyb3ciLCJyZXNwb25zaXZlIiwiYnJlYWtwb2ludCIsInNldHRpbmdzIiwidmFyaWFibGVXaWR0aCIsImVhY2giLCJpIiwicyIsInNsaWRlciIsImZpbmQiLCJzbGljayIsImFkZENsYXNzIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJwYXJlbnQiLCJyZW1vdmVDbGFzcyIsInNyYyIsInNldFRpbWVvdXQiLCJhdHRyIiwiZmlyc3QiLCJ0cmlnZ2VyIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJoaWRlIiwidGFiIiwiaW5kZXgiLCJnZXQiLCJ0YWdOYW1lIiwiY3NzIiwic2hvdyIsInRhYnMiLCJ0b2dnbGVDbGFzcyIsImlvblJhbmdlU2xpZGVyIiwicmFkaW9Xb3JrIiwicmFkaW8iLCJuYW1lIiwiY2xvc2VzdCIsIml6aU1vZGFsIiwibmF2IiwibW9kYWwiLCJhcHBlbmQiLCJtIiwiZ2FsbGVyeSIsImltZyIsImNsb25lIiwiaHRtbCIsImFjdGl2ZSIsImhhc0NsYXNzIiwicHJldiIsImxhc3QiLCJuZXh0IiwiZG9jdW1lbnQiLCJvZmYiLCJtYXNvbnJ5IiwiaXRlbVNlbGVjdG9yIiwiZ3V0dGVyIiwiaG9yaXpvbnRhbE9yZGVyIiwibGtBY3RpdmUiLCJwb2ludCIsImNhcmQiLCJzaWJsaW5ncyIsImxrRGlzYWJsZSIsImhvdmVyIiwiZCIsImNhcmRBZGFwdGl2ZSIsInciLCJ3aW5kb3ciLCJ3aWR0aCIsInVuc3RpY2siLCJpbnNlcnRBZnRlciIsImVtcHR5IiwiZ2V0Q29vcmRzIiwiZWxlbSIsInRvcCIsIm9mZnNldFRvcCIsImxlZnQiLCJvZmZzZXRMZWZ0IiwiYXJlYSIsImFyZWFCb3JkZXJzIiwiaGVpZ2h0IiwiY29vcmRzIiwic2hpZnRYIiwicGFnZVgiLCJzaGlmdFkiLCJwYWdlWSIsIm1vdmVBdCIsInN0eWxlIiwiekluZGV4IiwiZmllbGQiLCJpbnB1dCIsInZhbCIsIm9ubW91c2Vtb3ZlIiwib25tb3VzZXVwIiwib25kcmFnc3RhcnQiLCJpbmZvU3RpY2siLCJzdGlja3kiLCJ0b3BTcGFjaW5nIiwiYm90dG9tU3BhY2luZyIsInRvZ2dsZSIsInNjcm9sbFRvcCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxDQUFDLFVBQVNBLElBQVQsRUFBZTs7QUFFZixVQUFTQyxPQUFULEdBQW1CO0FBQ2xCO0FBQ0EsTUFBSUMsT0FBTztBQUNWQyxTQUFNO0FBQ0xDLFlBQVEsS0FESDtBQUVMQyxVQUFNLElBRkQ7QUFHTEMsVUFBTSxJQUhEO0FBSUxDLGNBQVUsSUFKTDtBQUtMQyxtQkFBZSxJQUxWO0FBTUxDLGtCQUFjO0FBTlQsSUFESTtBQVNWQyxVQUFPO0FBQ05DLGtCQUFjLENBRFI7QUFFTkMsZUFBV0MsRUFBRSxhQUFGLENBRkw7QUFHTkMsZUFBV0QsRUFBRSxhQUFGLENBSEw7QUFJTkUsZ0JBQVksQ0FDWDtBQUNDQyxpQkFBWSxJQURiO0FBRUNDLGVBQVU7QUFDVEMscUJBQWU7QUFETjtBQUZYLEtBRFcsRUFNVDtBQUNERixpQkFBWSxJQURYO0FBRURDLGVBQVU7QUFDVE4sb0JBQWM7QUFETDtBQUZULEtBTlMsRUFXVDtBQUNESyxpQkFBWSxHQURYO0FBRURDLGVBQVU7QUFDVE4sb0JBQWM7QUFETDtBQUZULEtBWFMsRUFnQlQ7QUFDREssaUJBQVksR0FEWDtBQUVEQyxlQUFVO0FBQ1ROLG9CQUFjO0FBREw7QUFGVCxLQWhCUztBQUpOO0FBVEcsR0FBWDs7QUF1Q0E7QUFDQUUsSUFBRSxTQUFGLEVBQWFNLElBQWIsQ0FBa0IsVUFBU0MsQ0FBVCxFQUFZQyxDQUFaLEVBQWU7QUFDaEMsT0FBSUMsU0FBU1QsRUFBRVEsQ0FBRixFQUFLbkIsSUFBTCxDQUFVLFFBQVYs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SUFGRCxNQUVPO0FBQ05qRyxNQUFFLE9BQUYsRUFBV2lHLE1BQVgsQ0FBa0I7QUFDakJDLGlCQUFZLEVBREs7QUFFakJDLG9CQUFlbkcsRUFBRSxnQkFBRixFQUFvQmlGLE1BQXBCLEtBQStCakYsRUFBRSxlQUFGLEVBQW1CaUYsTUFBbkIsRUFBL0IsR0FBNkRqRixFQUFFLFNBQUYsRUFBYWlGLE1BQWI7QUFGM0QsS0FBbEIsRUFHR3JFLFFBSEgsQ0FHWSxZQUhaO0FBSUE7QUFDRDtBQUNEOztBQUVEWixHQUFFb0UsTUFBRixFQUFVdkQsRUFBVixDQUFhLFFBQWIsRUFBdUJtRixTQUF2QjtBQUNBQTs7QUFFQWhHLEdBQUUsa0JBQUYsRUFBc0JhLEVBQXRCLENBQXlCLE9BQXpCLEVBQWtDbUYsU0FBbEM7O0FBR0FoRyxHQUFFLFdBQUYsRUFBZWEsRUFBZixDQUFrQixPQUFsQixFQUEyQixZQUFXO0FBQ3JDYixJQUFFLGdCQUFGLEVBQW9CaUcsTUFBcEI7QUFDQSxFQUZEOztBQUlBakcsR0FBRSxpQkFBRixFQUFxQmEsRUFBckIsQ0FBd0IsT0FBeEIsRUFBaUMsWUFBVztBQUMzQ2IsSUFBRSxJQUFGLEVBQVFvRCxJQUFSLENBQWEsVUFBYixFQUF5QmdELE1BQXpCO0FBQ0EsRUFGRDs7QUFJQXBHLEdBQUVvRSxNQUFGLEVBQVV2RCxFQUFWLENBQWEsUUFBYixFQUF1QixZQUFXO0FBQ2pDLE1BQUlMLElBQUksTUFBTVIsRUFBRW9FLE1BQUYsRUFBVWlDLFNBQVYsRUFBTixHQUE4QnJHLEVBQUUsT0FBRixFQUFXaUYsTUFBWCxFQUE5QixHQUFrRCxHQUExRDs7QUFFQWpGLElBQUUsS0FBRixFQUFTOEIsR0FBVCxDQUFhLEtBQWIsRUFBb0IsQ0FBQ3RCLENBQUQsR0FBRyxHQUF2QjtBQUNBLEVBSkQ7QUFPQSxDQXpZRCxFQXlZRzRELE1BellIIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbihyb290KSB7XG5cblx0ZnVuY3Rpb24gc2xpZGVycygpIHtcblx0XHQvLyDQn9Cw0YDQsNC80LXRgtGA0Ysg0YHQu9Cw0LnQtNC10YDQvtCyXG5cdFx0dmFyIGRhdGEgPSB7XG5cdFx0XHR0aWxlOiB7XG5cdFx0XHRcdGFycm93czogZmFsc2UsXG5cdFx0XHRcdGRvdHM6IHRydWUsXG5cdFx0XHRcdGZhZGU6IHRydWUsXG5cdFx0XHRcdGF1dG9wbGF5OiB0cnVlLFxuXHRcdFx0XHRhdXRvcGxheVNwZWVkOiA0MDAwLFxuXHRcdFx0XHRwYXVzZU9uSG92ZXI6IGZhbHNlXG5cdFx0XHR9LFxuXHRcdFx0cmVjb206IHtcblx0XHRcdFx0c2xpZGVzVG9TaG93OiA0LFxuXHRcdFx0XHRwcmV2QXJyb3c6ICQoJy5hcnJvd19wcmV2JyksXG5cdFx0XHRcdG5leHRBcnJvdzogJCgnLmFycm93X25leHQnKSxcblx0XHRcdFx0cmVzcG9uc2l2ZTogW1xuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGJyZWFrcG9pbnQ6IDEyMDAsXG5cdFx0XHRcdFx0XHRzZXR0aW5nczoge1xuXHRcdFx0XHRcdFx0XHR2YXJpYWJsZVdpZHRoOiB0cnVlXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSx7XG5cdFx0XHRcdFx0XHRicmVha3BvaW50OiAxMDAwLFxuXHRcdFx0XHRcdFx0c2V0dGluZ3M6IHtcblx0XHRcdFx0XHRcdFx0c2xpZGVzVG9TaG93OiAzXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSx7XG5cdFx0XHRcdFx0XHRicmVha3BvaW50OiA3NjgsXG5cdFx0XHRcdFx0XHRzZXR0aW5nczoge1xuXHRcdFx0XHRcdFx0XHRzbGlkZXNUb1Nob3c6IDJcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9LHtcblx0XHRcdFx0XHRcdGJyZWFrcG9pbnQ6IDUwMCxcblx0XHRcdFx0XHRcdHNldHRpbmdzOiB7XG5cdFx0XHRcdFx0XHRcdHNsaWRlc1RvU2hvdzogMVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyDQkNC60YLQuNCy0LDRhtC40Y8g0YHQu9Cw0LnQtNC10YDQvtCyXG5cdFx0JCgnLnNsaWRlcicpLmVhY2goZnVuY3Rpb24oaSwgcykge1xuXHRcdFx0dmFyIHNsaWRlciA9ICQocykuZGF0YSgnc2xpZGVyJyk7XG5cblx0XHRcdCQocykuZmluZCgnLnNsaWRlcl9fc2xpZGVzJykuc2xpY2soZGF0YVtzbGlkZXJdKTtcblx0XHR9KTtcblx0fVxuXG5cdHNsaWRlcnMoKTtcblxuXHQvLyDQk9Cw0LvQtdGA0LXRj1xuXHQkKCcuZ2FsbGVyeV9fdmlldycpLmFkZENsYXNzKCdzaG93Jyk7XG5cblx0JCgnLmdhbGxlcnlfX2l0ZW1zIGxpJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdCQodGhpcykucGFyZW50KCkuZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHQkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuXHRcdHZhciBzcmMgPSAkKHRoaXMpLmRhdGEoJ3ZpZXcnKTtcblxuXHRcdCQoJy5nYWxsZXJ5X192aWV3JykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCcuZ2FsbGVyeV9fdmlldyBpbWcnKS5hdHRyKCdzcmMnLHNyYyk7XG5cdFx0XHQkKCcuZ2FsbGVyeV9fdmlldycpLmFkZENsYXNzKCdzaG93Jyk7XG5cdFx0fSwgMzAwKVxuXG5cdFx0JCgnLm1vZGFsX3ZpZXcgLm1vZGFsX19nYWxsZXJ5IGltZycpLmF0dHIoJ3NyYycsc3JjKTtcblx0fSk7XG5cblx0JCgnLmdhbGxlcnlfX2l0ZW1zIGxpJykuZmlyc3QoKS50cmlnZ2VyKCdjbGljaycpO1xuXG5cdGlmICgkKCcuZ2FsbGVyeV9faXRlbXMnKS5jaGlsZHJlbigpLmxlbmd0aCA8PSAxKSB7XG5cdFx0JCgnLm1vZGFsX3ZpZXcgLm1vZGFsX19uYXYnKS5oaWRlKCk7XG5cdH1cblxuXHQvLyDQotCw0LHRi1xuXHQkKCcudGFicyBsaScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHQkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cdFx0JCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cblx0XHQkKCdbZGF0YS10YWJdJykuaGlkZSgpO1xuXG5cdFx0dmFyIHRhYiA9ICQoJ1tkYXRhLXRhYj1cIicrJCh0aGlzKS5pbmRleCgpKydcIl0nKS5nZXQoMCk7XG5cblx0XHRpZiAodGFiLnRhZ05hbWUgPT09ICdGT1JNJykge1xuXHRcdFx0JCh0YWIpLmNzcygnZGlzcGxheScsICdmbGV4Jyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQodGFiKS5zaG93KCk7XG5cdFx0fVxuXG5cdH0pO1xuXG5cdCQoJy50YWJzJykuZWFjaChmdW5jdGlvbihpLCB0YWJzKSB7XG5cdFx0JCh0YWJzKS5maW5kKCdsaScpLmZpcnN0KCkudHJpZ2dlcignY2xpY2snKTtcblx0fSlcblxuXHQvLyDQkdC+0LrQvtCy0L7QtSDQvNC10L3RjiDQsiDQutCw0YLQsNC70L7Qs9C1XG5cdCQoJy5zaWRlbmF2X19pdGVtX2Ryb3AgPiBhJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdCQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ3NpZGVuYXZfX2l0ZW1fc2hvdycpO1xuXHR9KTtcblxuXHQvLyDQn9C+0LvQt9GD0L3QvtC6XG5cdCQoJy5yYW5nZSBpbnB1dCcpLmlvblJhbmdlU2xpZGVyKCk7XG5cblx0Ly8g0KDQsNC00LjQvlxuXHRmdW5jdGlvbiByYWRpb1dvcmsocmFkaW8pIHtcblx0XHR2YXIgbmFtZSA9ICQocmFkaW8pLmF0dHIoJ25hbWUnKTtcblxuXHRcdCQoJy5yYWRpbyBpbnB1dFtuYW1lPScrbmFtZSsnXScpLmNsb3Nlc3QoJy5yYWRpbycpLnJlbW92ZUNsYXNzKCdyYWRpb19hY3RpdmUnKTtcblx0XHQkKHJhZGlvKS5jbG9zZXN0KCcucmFkaW8nKS5hZGRDbGFzcygncmFkaW9fYWN0aXZlJyk7XG5cdH1cblxuXHQkKCcucmFkaW8gaW5wdXQ6Y2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oaSwgcmFkaW8pIHtcblx0XHRyYWRpb1dvcmsocmFkaW8pO1xuXHR9KTtcblxuXHQkKCcucmFkaW8nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgcmFkaW8gPSAkKHRoaXMpLmZpbmQoJ2lucHV0JykuZ2V0KDApO1xuXG5cdFx0cmFkaW9Xb3JrKHJhZGlvKTtcblx0fSk7XG5cblx0Ly8g0JzQvtC00LDQu9C60LhcblxuXHQkKCdbZGF0YS1tb2RhbF0nKS5pemlNb2RhbCgpO1xuXG5cdCQoJy5tb2RhbF9fbmF2LCAubW9kYWxfX2Nsb3NlJykuZWFjaChmdW5jdGlvbihpLCBuYXYpIHtcblx0XHR2YXIgbW9kYWwgPSAkKG5hdikuY2xvc2VzdCgnLm1vZGFsJyk7XG5cblx0XHQkKG1vZGFsKS5hcHBlbmQobmF2KTtcblx0fSlcblxuXHQkKCdbZGF0YS1vcGVuXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHR2YXIgbSA9ICQodGhpcykuZGF0YSgnb3BlbicpLFxuXHRcdFx0XHRtb2RhbCA9ICQoJ1tkYXRhLW1vZGFsPVwiJyttKydcIl0nKSxcblx0XHRcdFx0Z2FsbGVyeSA9ICQodGhpcykuY2xvc2VzdCgnLmdhbGxlcnknKTtcblxuXHRcdC8vINC/0YDQtdCy0YzRjlxuXG5cdFx0aWYgKG0gPT09ICd2aWV3Jykge1xuXHRcdFx0dmFyIGltZyA9ICQodGhpcykuZmluZCgnaW1nJykuY2xvbmUoKTtcblxuXHRcdFx0JChtb2RhbCkuZmluZCgnLm1vZGFsX19nYWxsZXJ5JykuaHRtbChpbWcpO1xuXHRcdFx0JCgnLmdhbGxlcnlfX3ZpZXcnKS5hZGRDbGFzcygnaGlkZGVuJyk7XG5cblx0XHRcdCQoJy5tb2RhbF9fbmF2IC5hcnJvdycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciBhY3RpdmUgPSAkKGdhbGxlcnkpLmZpbmQoJy5hY3RpdmUnKTtcblxuXHRcdFx0XHRpZiAoJCh0aGlzKS5oYXNDbGFzcygnYXJyb3dfcHJldicpKSB7XG5cdFx0XHRcdFx0dmFyIHByZXYgPSAkKGFjdGl2ZSkucHJldigpLmdldCgwKTtcblxuXHRcdFx0XHRcdGlmICghcHJldikge1xuXHRcdFx0XHRcdFx0cHJldiA9ICQoZ2FsbGVyeSkuZmluZCgnLmdhbGxlcnlfX2l0ZW1zJykuY2hpbGRyZW4oKS5sYXN0KCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0JChhY3RpdmUpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdFx0XHQkKHByZXYpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgbmV4dCA9ICQoYWN0aXZlKS5uZXh0KCkuZ2V0KDApO1xuXG5cdFx0XHRcdFx0aWYgKCFuZXh0KSB7XG5cdFx0XHRcdFx0XHRuZXh0ID0gJChnYWxsZXJ5KS5maW5kKCcuZ2FsbGVyeV9faXRlbXMnKS5jaGlsZHJlbigpLmZpcnN0KCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0JChhY3RpdmUpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdFx0XHQkKG5leHQpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0JChtb2RhbCkuaXppTW9kYWwoJ29wZW4nKTtcblxuXHRcdCQoZG9jdW1lbnQpLm9uKCdjbG9zZWQnLCAnW2RhdGEtbW9kYWxdJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgJCgnLmdhbGxlcnlfX3ZpZXcuaGlkZGVuJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXHRcdFx0XHQkKCcubW9kYWxfX25hdiAuYXJyb3cnKS5vZmYoKTtcbiAgICB9KTtcblxuXG5cdH0pXG5cblx0Ly8g0KHQtdGC0LrQsFxuXG5cdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0JCgnLmdyaWQnKS5tYXNvbnJ5KHtcblx0XHRcdGl0ZW1TZWxlY3RvcjogJy5ncmlkX19pdGVtJyxcblx0XHRcdGd1dHRlcjogMTksXG5cdFx0XHRob3Jpem9udGFsT3JkZXI6IHRydWVcblx0XHR9KTtcblx0fSwgMTAwKVxuXG5cdC8vIGxvb2tib29rXG5cblx0ZnVuY3Rpb24gbGtBY3RpdmUocG9pbnQpIHtcblx0XHR2YXIgZGF0YSA9ICQocG9pbnQpLmRhdGEoJ2l0ZW0nKSxcblx0XHRcdFx0Y2FyZCA9ICQocG9pbnQpLmNsb3Nlc3QoJy5sb29rYm9vaycpLmZpbmQoJy5sb29rYm9va19fbGlzdCAuY2FyZFtkYXRhLWl0ZW09XCInK2RhdGErJ1wiXScpO1xuXG5cdFx0JChwb2ludCkuc2libGluZ3MoJy5wb2ludCcpLmFkZENsYXNzKCdwb2ludF9kaXNhYmxlJyk7XG5cdFx0JChjYXJkKS5yZW1vdmVDbGFzcygnY2FyZF9kaXNhYmxlJyk7XG5cdFx0JChjYXJkKS5zaWJsaW5ncygpLmFkZENsYXNzKCdjYXJkX2Rpc2FibGUnKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGxrRGlzYWJsZShwb2ludCkge1xuXHRcdCQocG9pbnQpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ3BvaW50X2Rpc2FibGUnKTtcblx0XHQkKHBvaW50KS5jbG9zZXN0KCcubG9va2Jvb2snKS5maW5kKCcuY2FyZF9kaXNhYmxlJykucmVtb3ZlQ2xhc3MoJ2NhcmRfZGlzYWJsZScpO1xuXHR9XG5cblx0JCgnLnBvaW50JykuaG92ZXIoZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5wYXJlbnQoKS5maW5kKCcucG9pbnRfYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ3BvaW50X2FjdGl2ZScpLnNpYmxpbmdzKCcucG9pbnRfZGlzYWJsZScpLnJlbW92ZUNsYXNzKCdwb2ludF9kaXNhYmxlJyk7XG5cdFx0bGtBY3RpdmUodGhpcyk7XG5cdH0sIGZ1bmN0aW9uKCkge1xuXHRcdGlmICgkKHRoaXMpLmhhc0NsYXNzKCdwb2ludF9hY3RpdmUnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRsa0Rpc2FibGUodGhpcyk7XG5cdH0pXG5cblx0JCgnLnBvaW50Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5hZGRDbGFzcygncG9pbnRfYWN0aXZlJyk7XG5cdFx0bGtBY3RpdmUodGhpcyk7XG5cdH0pO1xuXG5cdCQoJy5sb29rYm9va19fbGlzdCAuY2FyZCcpLmhvdmVyKGZ1bmN0aW9uKCkge1xuXHRcdFx0JCh0aGlzKS5zaWJsaW5ncygpLmFkZENsYXNzKCdjYXJkX2Rpc2FibGUnKTtcblx0XHRcdHZhciBkID0gJCh0aGlzKS5kYXRhKCdpdGVtJyk7XG5cdFx0XHQkKCcucG9pbnRbZGF0YS1pdGVtPScrZCsnXScpLmFkZENsYXNzKCdwb2ludF9hY3RpdmUnKTtcblx0fSwgZnVuY3Rpb24oKSB7XG5cdFx0JCgnLmxvb2tib29rX19saXN0IC5jYXJkJykucmVtb3ZlQ2xhc3MoJ2NhcmRfZGlzYWJsZScpO1xuXHRcdCQoJy5wb2ludF9hY3RpdmUnKS5yZW1vdmVDbGFzcygncG9pbnRfYWN0aXZlJyk7XG5cdH0pO1xuXG5cdC8vINCa0LDRgNGC0L7Rh9C60LAg0LDQtNCw0L/RgtC40LJcblxuXHRmdW5jdGlvbiBjYXJkQWRhcHRpdmUoKSB7XG5cdFx0dmFyIHcgPSAkKHdpbmRvdykud2lkdGgoKTtcblxuXHRcdGlmICh3IDw9IDEwMDApIHtcblx0XHRcdGlmICghJCgnLmluZm9fdmVydGljYWwnKS5nZXQoMCkpIHtcblx0XHRcdFx0JChcIi5pbmZvXCIpLnVuc3RpY2soKS5yZW1vdmVDbGFzcygnaW5mb19zdGljaycpO1xuXHRcdFx0XHQkKCcuaW5mbycpLmluc2VydEFmdGVyKCcuZ2FsbGVyeScpO1xuXHRcdFx0XHQkKCcuYy1wYWdlX19pbmZvJykuZW1wdHkoKTtcblx0XHRcdFx0JCgnLmluZm8nKS5yZW1vdmVDbGFzcygnaW5mb19ob3Jpem9udGFsJykuYWRkQ2xhc3MoJ2luZm9fdmVydGljYWwnKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCEkKCcuaW5mb19ob3Jpem9udGFsJykuZ2V0KDApKSB7XG5cdFx0XHRcdCQoJy5jLXBhZ2VfX2luZm8nKS5hcHBlbmQoJCgnLmluZm8nKSk7XG5cdFx0XHRcdCQoJy5pbmZvJykucmVtb3ZlQ2xhc3MoJ2luZm9fdmVydGljYWwnKS5hZGRDbGFzcygnaW5mb19ob3Jpem9udGFsJyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Y2FyZEFkYXB0aXZlKCk7XG5cdCQod2luZG93KS5vbigncmVzaXplJywgY2FyZEFkYXB0aXZlKTtcblxuXHQvLyDQnNC10L3RjlxuXG5cdCQoJy5tZW51Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdCQodGhpcykuY2xvc2VzdCgnLmhlYWRlcicpLnRvZ2dsZUNsYXNzKCdoZWFkZXJfc2hvdy1tZW51Jylcblx0fSlcblxuXHQvLyDQk9C+0YDQvtC0XG5cblx0JCgnLmNpdHlfX2N1cnJlbnQnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0JCgnLmNpdHknKS50b2dnbGVDbGFzcygnY2l0eV9zaG93Jyk7XG5cdH0pXG5cblx0Ly8gbG9va2Jvb2sgZWRpdG9yXG5cblx0ZnVuY3Rpb24gZ2V0Q29vcmRzKGVsZW0pIHtcblx0ICByZXR1cm4ge1xuXHQgICAgdG9wOiBlbGVtLm9mZnNldFRvcCxcblx0ICAgIGxlZnQ6IGVsZW0ub2Zmc2V0TGVmdFxuXHQgIH07XG5cdH1cblxuXHR2YXIgcG9pbnQgPSAkKCcucG9pbnRfbW92ZScpLmdldCgwKSxcblx0XHRcdGFyZWEgPSAkKCcubG9va2Jvb2tfX3NldCBpbWcnKSxcblx0XHRcdGFyZWFCb3JkZXJzID0ge1xuXHRcdFx0XHR0b3A6ICQoYXJlYSkuaGVpZ2h0KCkgLSAyNCxcblx0XHRcdFx0bGVmdDogJChhcmVhKS53aWR0aCgpIC0gMjRcblx0XHRcdH07XG5cblx0JChwb2ludCkub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHR2YXIgY29vcmRzID0gZ2V0Q29vcmRzKHBvaW50KSxcblx0XHRcdFx0c2hpZnRYID0gZS5wYWdlWCAtIGNvb3Jkcy5sZWZ0LFxuICBcdFx0XHRzaGlmdFkgPSBlLnBhZ2VZIC0gY29vcmRzLnRvcDtcblxuXHQgIG1vdmVBdChlKTtcblxuXHQgIHBvaW50LnN0eWxlLnpJbmRleCA9IDEwMDA7IC8vINC90LDQtCDQtNGA0YPQs9C40LzQuCDRjdC70LXQvNC10L3RgtCw0LzQuFxuXG5cdFx0ZnVuY3Rpb24gbW92ZUF0KGUpIHtcblx0XHRcdHZhciB0b3AgPSBlLnBhZ2VZIC0gc2hpZnRZLFxuXHRcdFx0XHRcdGxlZnQgPSBlLnBhZ2VYIC0gc2hpZnRYO1xuXG5cdFx0XHRpZiAobGVmdCA+PSBhcmVhQm9yZGVycy5sZWZ0KSB7XG5cdFx0XHRcdGxlZnQgPSBhcmVhQm9yZGVycy5sZWZ0XG5cdFx0XHR9IGVsc2UgaWYgKGxlZnQgPD0gMCl7XG5cdFx0XHRcdGxlZnQgPSAwO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodG9wIDw9IDApIHtcblx0XHRcdFx0dG9wID0gMDtcblx0XHRcdH0gZWxzZSBpZiAodG9wID49IGFyZWFCb3JkZXJzLnRvcCkge1xuXHRcdFx0XHR0b3AgPSBhcmVhQm9yZGVycy50b3Bcblx0XHRcdH1cblxuXHQgICAgcG9pbnQuc3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuXHQgICAgcG9pbnQuc3R5bGUudG9wID0gdG9wICArICdweCc7XG5cblx0XHRcdCQoJ1tkYXRhLWNvb3Jkc10nKS5lYWNoKGZ1bmN0aW9uKGksIGZpZWxkKSB7XG5cdFx0XHRcdHZhciBjb29yZHMgPSAkKHRoaXMpLmRhdGEoJ2Nvb3JkcycpLFxuXHRcdFx0XHRcdFx0aW5wdXQgPSAkKHRoaXMpLmZpbmQoJ2lucHV0Jyk7XG5cblx0XHRcdFx0c3dpdGNoIChjb29yZHMpIHtcblx0XHRcdFx0XHRjYXNlICd0b3AnOlxuXHRcdFx0XHRcdFx0JChpbnB1dCkudmFsKHRvcCk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICdsZWZ0Jzpcblx0XHRcdFx0XHRcdCQoaW5wdXQpLnZhbChsZWZ0KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0ICB9XG5cblx0XHRkb2N1bWVudC5vbm1vdXNlbW92ZSA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgIG1vdmVBdChlKTtcblx0ICB9O1xuXG5cdCAgcG9pbnQub25tb3VzZXVwID0gZnVuY3Rpb24oKSB7XG5cdCAgICBkb2N1bWVudC5vbm1vdXNlbW92ZSA9IG51bGw7XG5cdCAgICBwb2ludC5vbm1vdXNldXAgPSBudWxsO1xuXHQgIH07XG5cblx0XHRwb2ludC5vbmRyYWdzdGFydCA9IGZ1bmN0aW9uKCkge1xuXHRcdCAgcmV0dXJuIGZhbHNlO1xuXHRcdH07XG5cdH0pXG5cblx0Ly8g0JjQvdGE0L4g0LIg0LrQsNGA0YLQvtGH0LrQtVxuXG5cdGZ1bmN0aW9uIGluZm9TdGljaygpIHtcblx0XHRpZiAoJCh3aW5kb3cpLndpZHRoKCkgPiAxMDAwKSB7XG5cdFx0XHRpZiAoJCgnLmluZm8nKS5oYXNDbGFzcygnaW5mb19zdGljaycpKSB7XG5cdFx0XHRcdCQoJy5pbmZvJykuc3RpY2t5KCd1cGRhdGUnKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCQoJy5pbmZvJykuc3RpY2t5KHtcblx0XHRcdFx0XHR0b3BTcGFjaW5nOiAyMCxcblx0XHRcdFx0XHRib3R0b21TcGFjaW5nOiAkKCcucGFnZV9fd3JhcHBlcicpLmhlaWdodCgpIC0gJCgnLmMtcGFnZV9fbWFpbicpLmhlaWdodCgpICsgJCgnLmZvb3RlcicpLmhlaWdodCgpXG5cdFx0XHRcdH0pLmFkZENsYXNzKCdpbmZvX3N0aWNrJyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0JCh3aW5kb3cpLm9uKCdyZXNpemUnLCBpbmZvU3RpY2spO1xuXHRpbmZvU3RpY2soKTtcblxuXHQkKCcuYy1wYWdlIC50YWJzIGxpJykub24oJ2NsaWNrJywgaW5mb1N0aWNrKTtcblxuXG5cdCQoJy5sa19faXRlbScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdCQoJy5sb29rYm9va19fc2V0Jykuc3RpY2t5KClcblx0fSk7XG5cblx0JCgnLnBhZ2VfX3NpZGUtbmF2Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCh0aGlzKS5uZXh0KCcuc2lkZW5hdicpLnRvZ2dsZSgpO1xuXHR9KVxuXG5cdCQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHMgPSAxMDAgKiAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgLyAkKCcucGFnZScpLmhlaWdodCgpKjEuODtcblxuXHRcdCQoJy5iZycpLmNzcygndG9wJywgLXMrJyUnKTtcblx0fSlcblxuXG59KSh3aW5kb3cpO1xuIl19
