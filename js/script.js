'use strict';

(function (root) {

	function sliders() {
		// Параметры слайдеров
		var data = {
			tile: {
				arrows: false,
				dots: true,
				fade: true,
				autoplay: true,
				autoplaySpeed: 4000,
				pauseOnHover: false
			},
			recom: {
				slidesToShow: 4,
				prevArrow: $('.arrow_prev'),
				nextArrow: $('.arrow_next'),
				responsive: [{
					breakpoint: 1200,
					settings: {
						variableWidth: true
					}
				}, {
					breakpoint: 1000,
					settings: {
						slidesToShow: 3
					}
				}, {
					breakpoint: 768,
					settings: {
						slidesToShow: 2
					}
				}, {
					breakpoint: 500,
					settings: {
						slidesToShow: 1
					}
				}]
			}
		};

		// Активация слайдеров
		$('.slider').each(function (i, s) {
			var slider = $(s).data('slider');

			$(s).find('.slider__slides').slick(data[slider]);
		});
	}

	sliders();

	// Галерея
	$('.gallery__view').addClass('show');

	$('.gallery__items li').on('click', function (e) {
		e.preventDefault();

		$(this).parent().find('.active').removeClass('active');
		$(this).addClass('active');

		var src = $(this).data('view');

		$('.gallery__view').removeClass('show');

		setTimeout(function () {
			$('.gallery__view img').attr('src', src);
			$('.gallery__view').addClass('show');
		}, 300);

		$('.modal_view .modal__gallery img').attr('src', src);
	});

	$('.gallery__items li').first().trigger('click');

	if ($('.gallery__items').children().length <= 1) {
		$('.modal_view .modal__nav').hide();
	}

	// Табы
	$('.tabs li').on('click', function (e) {
		e.preventDefault();

		$(this).parent().find('.active').removeClass('active');
		$(this).addClass('active');

		$('[data-tab]').hide();

		var tab = $('[data-tab="' + $(this).index() + '"]').get(0);

		if (tab.tagName === 'FORM') {
			$(tab).css('display', 'flex');
		} else {
			$(tab).show();
		}
	});

	$('.tabs').each(function (i, tabs) {
		$(tabs).find('li').first().trigger('click');
	});

	// Боковое меню в каталоге
	$('.sidenav__item_drop > a').on('click', function (e) {
		e.preventDefault();

		$(this).parent().toggleClass('sidenav__item_show');
	});

	// Ползунок
	$('.range input').ionRangeSlider();

	// Радио
	function radioWork(radio) {
		var name = $(radio).attr('name');

		$('.radio input[name=' + name + ']').closest('.radio').removeClass('radio_active');
		$(radio).closest('.radio').addClass('radio_active');
	}

	$('.radio input:checked').each(function (i, radio) {
		radioWork(radio);
	});

	$('.radio').on('click', function () {
		var radio = $(this).find('input').get(0);

		radioWork(radio);
	});

	// Модалки

	$('[data-modal]').iziModal();

	$('.modal__nav, .modal__close').each(function (i, nav) {
		var modal = $(nav).closest('.modal');

		$(modal).append(nav);
	});

	$('[data-open]').on('click', function (e) {
		e.preventDefault();

		var m = $(this).data('open'),
		    modal = $('[data-modal="' + m + '"]'),
		    gallery = $(this).closest('.gallery');

		// превью

		if (m === 'view') {
			var img = $(this).find('img').clone();

			$(modal).find('.modal__gallery').html(img);
			$('.gallery__view').addClass('hidden');

			$('.modal__nav .arrow').on('click', function () {

				var active = $(gallery).find('.active');

				if ($(this).hasClass('arrow_prev')) {
					var prev = $(active).prev().get(0);

					if (!prev) {
						prev = $(gallery).find('.gallery__items').children().last();
					}

					$(active).removeClass('active');
					$(prev).trigger('click');
				} else {
					var next = $(active).next().get(0);

					if (!next) {
						next = $(gallery).find('.gallery__items').children().first();
					}

					$(active).removeClass('active');
					$(next).trigger('click');
				}
			});
		}

		$(modal).iziModal('open');

		$(document).on('closed', '[data-modal]', function (e) {
			$('.gallery__view.hidden').removeClass('hidden');
			$('.modal__nav .arrow').off();
		});
	});

	// Сетка

	setTimeout(function () {
		$('.grid').masonry({
			itemSelector: '.grid__item',
			gutter: 19,
			horizontalOrder: true
		});
	}, 100);

	// lookbook

	function lkActive(point) {
		var data = $(point).data('item'),
		    card = $(point).closest('.lookbook').find('.lookbook__list .card[data-item="' + data + '"]');

		$(point).siblings('.point').addClass('point_disable');
		$(card).removeClass('card_disable');
		$(card).siblings().addClass('card_disable');
	}

	function lkDisable(point) {
		$(point).siblings().removeClass('point_disable');
		$(point).closest('.lookbook').find('.card_disable').removeClass('card_disable');
	}

	$('.point').hover(function () {
		$(this).parent().find('.point_active').removeClass('point_active').siblings('.point_disable').removeClass('point_disable');
		lkActive(this);
	}, function () {
		if ($(this).hasClass('point_active')) {
			return;
		}
		lkDisable(this);
	});

	$('.point').on('click', function () {
		$(this).addClass('point_active');
		lkActive(this);
	});

	$('.lookbook__list .card').hover(function () {
		$(this).siblings().addClass('card_disable');
		var d = $(this).data('item');
		$('.point[data-item=' + d + ']').addClass('point_active');
	}, function () {
		$('.lookbook__list .card').removeClass('card_disable');
		$('.point_active').removeClass('point_active');
	});

	// Карточка адаптив

	function cardAdaptive() {
		var w = $(window).width();

		if (w <= 1000) {
			if (!$('.info_vertical').get(0)) {
				$(".info").unstick().removeClass('info_stick');
				$('.info').insertAfter('.gallery');
				$('.c-page__info').empty();
				$('.info').removeClass('info_horizontal').addClass('info_vertical');
			}
		} else {
			if (!$('.info_horizontal').get(0)) {
				$('.c-page__info').append($('.info'));
				$('.info').removeClass('info_vertical').addClass('info_horizontal');
			}
		}
	}

	cardAdaptive();
	$(window).on('resize', cardAdaptive);

	// Меню

	$('.menu').on('click', function (e) {
		e.preventDefault();

		$(this).closest('.header').toggleClass('header_show-menu');
	});

	// Город

	$('.city__current').on('click', function (e) {
		e.preventDefault();

		$('.city').toggleClass('city_show');
	});

	// lookbook editor

	function getCoords(elem) {
		return {
			top: elem.offsetTop,
			left: elem.offsetLeft
		};
	}

	var point = $('.point_move').get(0),
	    area = $('.lookbook__set img'),
	    areaBorders = {
		top: $(area).height() - 24,
		left: $(area).width() - 24
	};

	$(point).on('mousedown', function (e) {
		e.preventDefault();

		var coords = getCoords(point),
		    shiftX = e.pageX - coords.left,
		    shiftY = e.pageY - coords.top;

		moveAt(e);

		point.style.zIndex = 1000; // над другими элементами

		function moveAt(e) {
			var top = e.pageY - shiftY,
			    left = e.pageX - shiftX;

			if (left >= areaBorders.left) {
				left = areaBorders.left;
			} else if (left <= 0) {
				left = 0;
			}

			if (top <= 0) {
				top = 0;
			} else if (top >= areaBorders.top) {
				top = areaBorders.top;
			}

			point.style.left = left + 'px';
			point.style.top = top + 'px';

			$('[data-coords]').each(function (i, field) {
				var coords = $(this).data('coords'),
				    input = $(this).find('input');

				switch (coords) {
					case 'top':
						$(input).val(top);
						break;
					case 'left':
						$(input).val(left);
						break;
				}
			});
		}

		document.onmousemove = function (e) {
			moveAt(e);
		};

		point.onmouseup = function () {
			document.onmousemove = null;
			point.onmouseup = null;
		};

		point.ondragstart = function () {
			return false;
		};
	});

	// Инфо в карточке

	function infoStick() {
		if ($(window).width() > 1000) {
			if ($('.info').hasClass('info_stick')) {
				$('.info').sticky('update');
			} else {
				$('.info').sticky({
					topSpacing: 20,
					bottomSpacing: $('.page__wrapper').height() - $('.c-page__main').height() + $('.footer').height()
				}).addClass('info_stick');
			}
		}
	}

	$(window).on('resize', infoStick);
	infoStick();

	$('.c-page .tabs li').on('click', infoStick);

	$('.lk__item').on('click', function () {
		$('.lookbook__set').sticky();
	});

	$('.page__side-nav').on('click', function () {
		$(this).next('.sidenav').toggle();
	});
})(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJyb290Iiwic2xpZGVycyIsImRhdGEiLCJ0aWxlIiwiYXJyb3dzIiwiZG90cyIsImZhZGUiLCJhdXRvcGxheSIsImF1dG9wbGF5U3BlZWQiLCJwYXVzZU9uSG92ZXIiLCJyZWNvbSIsInNsaWRlc1RvU2hvdyIsInByZXZBcnJvdyIsIiQiLCJuZXh0QXJyb3ciLCJyZXNwb25zaXZlIiwiYnJlYWtwb2ludCIsInNldHRpbmdzIiwidmFyaWFibGVXaWR0aCIsImVhY2giLCJpIiwicyIsInNsaWRlciIsImZpbmQiLCJzbGljayIsImFkZENsYXNzIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJwYXJlbnQiLCJyZW1vdmVDbGFzcyIsInNyYyIsInNldFRpbWVvdXQiLCJhdHRyIiwiZmlyc3QiLCJ0cmlnZ2VyIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJoaWRlIiwidGFiIiwiaW5kZXgiLCJnZXQiLCJ0YWdOYW1lIiwiY3NzIiwic2hvdyIsInRhYnMiLCJ0b2dnbGVDbGFzcyIsImlvblJhbmdlU2xpZGVyIiwicmFkaW9Xb3JrIiwicmFkaW8iLCJuYW1lIiwiY2xvc2VzdCIsIml6aU1vZGFsIiwibmF2IiwibW9kYWwiLCJhcHBlbmQiLCJtIiwiZ2FsbGVyeSIsImltZyIsImNsb25lIiwiaHRtbCIsImFjdGl2ZSIsImhhc0NsYXNzIiwicHJldiIsImxhc3QiLCJuZXh0IiwiZG9jdW1lbnQiLCJvZmYiLCJtYXNvbnJ5IiwiaXRlbVNlbGVjdG9yIiwiZ3V0dGVyIiwiaG9yaXpvbnRhbE9yZGVyIiwibGtBY3RpdmUiLCJwb2ludCIsImNhcmQiLCJzaWJsaW5ncyIsImxrRGlzYWJsZSIsImhvdmVyIiwiZCIsImNhcmRBZGFwdGl2ZSIsInciLCJ3aW5kb3ciLCJ3aWR0aCIsInVuc3RpY2siLCJpbnNlcnRBZnRlciIsImVtcHR5IiwiZ2V0Q29vcmRzIiwiZWxlbSIsInRvcCIsIm9mZnNldFRvcCIsImxlZnQiLCJvZmZzZXRMZWZ0IiwiYXJlYSIsImFyZWFCb3JkZXJzIiwiaGVpZ2h0IiwiY29vcmRzIiwic2hpZnRYIiwicGFnZVgiLCJzaGlmdFkiLCJwYWdlWSIsIm1vdmVBdCIsInN0eWxlIiwiekluZGV4IiwiZmllbGQiLCJpbnB1dCIsInZhbCIsIm9ubW91c2Vtb3ZlIiwib25tb3VzZXVwIiwib25kcmFnc3RhcnQiLCJpbmZvU3RpY2siLCJzdGlja3kiLCJ0b3BTcGFjaW5nIiwiYm90dG9tU3BhY2luZyIsInRvZ2dsZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxDQUFDLFVBQVNBLElBQVQsRUFBZTs7QUFFZixVQUFTQyxPQUFULEdBQW1CO0FBQ2xCO0FBQ0EsTUFBSUMsT0FBTztBQUNWQyxTQUFNO0FBQ0xDLFlBQVEsS0FESDtBQUVMQyxVQUFNLElBRkQ7QUFHTEMsVUFBTSxJQUhEO0FBSUxDLGNBQVUsSUFKTDtBQUtMQyxtQkFBZSxJQUxWO0FBTUxDLGtCQUFjO0FBTlQsSUFESTtBQVNWQyxVQUFPO0FBQ05DLGtCQUFjLENBRFI7QUFFTkMsZUFBV0MsRUFBRSxhQUFGLENBRkw7QUFHTkMsZUFBV0QsRUFBRSxhQUFGLENBSEw7QUFJTkUsZ0JBQVksQ0FDWDtBQUNDQyxpQkFBWSxJQURiO0FBRUNDLGVBQVU7QUFDVEMscUJBQWU7QUFETjtBQUZYLEtBRFcsRUFNVDtBQUNERixpQkFBWSxJQURYO0FBRURDLGVBQVU7QUFDVE4sb0JBQWM7QUFETDtBQUZULEtBTlMsRUFXVDtBQUNESyxpQkFBWSxHQURYO0FBRURDLGVBQVU7QUFDVE4sb0JBQWM7QUFETDtBQUZULEtBWFMsRUFnQlQ7QUFDREssaUJBQVksR0FEWDtBQUVEQyxlQUFVO0FBQ1ROLG9CQUFjO0FBREw7QUFGVCxLQWhCUztBQUpOO0FBVEcsR0FBWDs7QUF1Q0E7QUFDQUUsSUFBRSxTQUFGLEVBQWFNLElBQWIsQ0FBa0IsVUFBU0MsQ0FBVCxFQUFZQyxDQUFaLEVBQWU7QUFDaEMsT0FBSUMsU0FBU1QsRUFBRVEsQ0FBRixFQUFLbkIsSUFBTCxDQUFVLFFBQVYsQ0FBYjs7QUFFQVcs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Q05qRyxNQUFFLE9BQUYsRUFBV2lHLE1BQVgsQ0FBa0I7QUFDakJDLGlCQUFZLEVBREs7QUFFakJDLG9CQUFlbkcsRUFBRSxnQkFBRixFQUFvQmlGLE1BQXBCLEtBQStCakYsRUFBRSxlQUFGLEVBQW1CaUYsTUFBbkIsRUFBL0IsR0FBNkRqRixFQUFFLFNBQUYsRUFBYWlGLE1BQWI7QUFGM0QsS0FBbEIsRUFHR3JFLFFBSEgsQ0FHWSxZQUhaO0FBSUE7QUFDRDtBQUNEOztBQUVEWixHQUFFb0UsTUFBRixFQUFVdkQsRUFBVixDQUFhLFFBQWIsRUFBdUJtRixTQUF2QjtBQUNBQTs7QUFFQWhHLEdBQUUsa0JBQUYsRUFBc0JhLEVBQXRCLENBQXlCLE9BQXpCLEVBQWtDbUYsU0FBbEM7O0FBR0FoRyxHQUFFLFdBQUYsRUFBZWEsRUFBZixDQUFrQixPQUFsQixFQUEyQixZQUFXO0FBQ3JDYixJQUFFLGdCQUFGLEVBQW9CaUcsTUFBcEI7QUFDQSxFQUZEOztBQUlBakcsR0FBRSxpQkFBRixFQUFxQmEsRUFBckIsQ0FBd0IsT0FBeEIsRUFBaUMsWUFBVztBQUMzQ2IsSUFBRSxJQUFGLEVBQVFvRCxJQUFSLENBQWEsVUFBYixFQUF5QmdELE1BQXpCO0FBQ0EsRUFGRDtBQUtBLENBbllELEVBbVlHaEMsTUFuWUgiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKHJvb3QpIHtcblxuXHRmdW5jdGlvbiBzbGlkZXJzKCkge1xuXHRcdC8vINCf0LDRgNCw0LzQtdGC0YDRiyDRgdC70LDQudC00LXRgNC+0LJcblx0XHR2YXIgZGF0YSA9IHtcblx0XHRcdHRpbGU6IHtcblx0XHRcdFx0YXJyb3dzOiBmYWxzZSxcblx0XHRcdFx0ZG90czogdHJ1ZSxcblx0XHRcdFx0ZmFkZTogdHJ1ZSxcblx0XHRcdFx0YXV0b3BsYXk6IHRydWUsXG5cdFx0XHRcdGF1dG9wbGF5U3BlZWQ6IDQwMDAsXG5cdFx0XHRcdHBhdXNlT25Ib3ZlcjogZmFsc2Vcblx0XHRcdH0sXG5cdFx0XHRyZWNvbToge1xuXHRcdFx0XHRzbGlkZXNUb1Nob3c6IDQsXG5cdFx0XHRcdHByZXZBcnJvdzogJCgnLmFycm93X3ByZXYnKSxcblx0XHRcdFx0bmV4dEFycm93OiAkKCcuYXJyb3dfbmV4dCcpLFxuXHRcdFx0XHRyZXNwb25zaXZlOiBbXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0YnJlYWtwb2ludDogMTIwMCxcblx0XHRcdFx0XHRcdHNldHRpbmdzOiB7XG5cdFx0XHRcdFx0XHRcdHZhcmlhYmxlV2lkdGg6IHRydWVcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9LHtcblx0XHRcdFx0XHRcdGJyZWFrcG9pbnQ6IDEwMDAsXG5cdFx0XHRcdFx0XHRzZXR0aW5nczoge1xuXHRcdFx0XHRcdFx0XHRzbGlkZXNUb1Nob3c6IDNcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9LHtcblx0XHRcdFx0XHRcdGJyZWFrcG9pbnQ6IDc2OCxcblx0XHRcdFx0XHRcdHNldHRpbmdzOiB7XG5cdFx0XHRcdFx0XHRcdHNsaWRlc1RvU2hvdzogMlxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0se1xuXHRcdFx0XHRcdFx0YnJlYWtwb2ludDogNTAwLFxuXHRcdFx0XHRcdFx0c2V0dGluZ3M6IHtcblx0XHRcdFx0XHRcdFx0c2xpZGVzVG9TaG93OiAxXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRdXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vINCQ0LrRgtC40LLQsNGG0LjRjyDRgdC70LDQudC00LXRgNC+0LJcblx0XHQkKCcuc2xpZGVyJykuZWFjaChmdW5jdGlvbihpLCBzKSB7XG5cdFx0XHR2YXIgc2xpZGVyID0gJChzKS5kYXRhKCdzbGlkZXInKTtcblxuXHRcdFx0JChzKS5maW5kKCcuc2xpZGVyX19zbGlkZXMnKS5zbGljayhkYXRhW3NsaWRlcl0pO1xuXHRcdH0pO1xuXHR9XG5cblx0c2xpZGVycygpO1xuXG5cdC8vINCT0LDQu9C10YDQtdGPXG5cdCQoJy5nYWxsZXJ5X192aWV3JykuYWRkQ2xhc3MoJ3Nob3cnKTtcblxuXHQkKCcuZ2FsbGVyeV9faXRlbXMgbGknKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0JCh0aGlzKS5wYXJlbnQoKS5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdCQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG5cdFx0dmFyIHNyYyA9ICQodGhpcykuZGF0YSgndmlldycpO1xuXG5cdFx0JCgnLmdhbGxlcnlfX3ZpZXcnKS5yZW1vdmVDbGFzcygnc2hvdycpO1xuXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdCQoJy5nYWxsZXJ5X192aWV3IGltZycpLmF0dHIoJ3NyYycsc3JjKTtcblx0XHRcdCQoJy5nYWxsZXJ5X192aWV3JykuYWRkQ2xhc3MoJ3Nob3cnKTtcblx0XHR9LCAzMDApXG5cblx0XHQkKCcubW9kYWxfdmlldyAubW9kYWxfX2dhbGxlcnkgaW1nJykuYXR0cignc3JjJyxzcmMpO1xuXHR9KTtcblxuXHQkKCcuZ2FsbGVyeV9faXRlbXMgbGknKS5maXJzdCgpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cblx0aWYgKCQoJy5nYWxsZXJ5X19pdGVtcycpLmNoaWxkcmVuKCkubGVuZ3RoIDw9IDEpIHtcblx0XHQkKCcubW9kYWxfdmlldyAubW9kYWxfX25hdicpLmhpZGUoKTtcblx0fVxuXG5cdC8vINCi0LDQsdGLXG5cdCQoJy50YWJzIGxpJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdCQodGhpcykucGFyZW50KCkuZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHQkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuXHRcdCQoJ1tkYXRhLXRhYl0nKS5oaWRlKCk7XG5cblx0XHR2YXIgdGFiID0gJCgnW2RhdGEtdGFiPVwiJyskKHRoaXMpLmluZGV4KCkrJ1wiXScpLmdldCgwKTtcblxuXHRcdGlmICh0YWIudGFnTmFtZSA9PT0gJ0ZPUk0nKSB7XG5cdFx0XHQkKHRhYikuY3NzKCdkaXNwbGF5JywgJ2ZsZXgnKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0JCh0YWIpLnNob3coKTtcblx0XHR9XG5cblx0fSk7XG5cblx0JCgnLnRhYnMnKS5lYWNoKGZ1bmN0aW9uKGksIHRhYnMpIHtcblx0XHQkKHRhYnMpLmZpbmQoJ2xpJykuZmlyc3QoKS50cmlnZ2VyKCdjbGljaycpO1xuXHR9KVxuXG5cdC8vINCR0L7QutC+0LLQvtC1INC80LXQvdGOINCyINC60LDRgtCw0LvQvtCz0LVcblx0JCgnLnNpZGVuYXZfX2l0ZW1fZHJvcCA+IGEnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0JCh0aGlzKS5wYXJlbnQoKS50b2dnbGVDbGFzcygnc2lkZW5hdl9faXRlbV9zaG93Jyk7XG5cdH0pO1xuXG5cdC8vINCf0L7Qu9C30YPQvdC+0Lpcblx0JCgnLnJhbmdlIGlucHV0JykuaW9uUmFuZ2VTbGlkZXIoKTtcblxuXHQvLyDQoNCw0LTQuNC+XG5cdGZ1bmN0aW9uIHJhZGlvV29yayhyYWRpbykge1xuXHRcdHZhciBuYW1lID0gJChyYWRpbykuYXR0cignbmFtZScpO1xuXG5cdFx0JCgnLnJhZGlvIGlucHV0W25hbWU9JytuYW1lKyddJykuY2xvc2VzdCgnLnJhZGlvJykucmVtb3ZlQ2xhc3MoJ3JhZGlvX2FjdGl2ZScpO1xuXHRcdCQocmFkaW8pLmNsb3Nlc3QoJy5yYWRpbycpLmFkZENsYXNzKCdyYWRpb19hY3RpdmUnKTtcblx0fVxuXG5cdCQoJy5yYWRpbyBpbnB1dDpjaGVja2VkJykuZWFjaChmdW5jdGlvbihpLCByYWRpbykge1xuXHRcdHJhZGlvV29yayhyYWRpbyk7XG5cdH0pO1xuXG5cdCQoJy5yYWRpbycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdHZhciByYWRpbyA9ICQodGhpcykuZmluZCgnaW5wdXQnKS5nZXQoMCk7XG5cblx0XHRyYWRpb1dvcmsocmFkaW8pO1xuXHR9KTtcblxuXHQvLyDQnNC+0LTQsNC70LrQuFxuXG5cdCQoJ1tkYXRhLW1vZGFsXScpLml6aU1vZGFsKCk7XG5cblx0JCgnLm1vZGFsX19uYXYsIC5tb2RhbF9fY2xvc2UnKS5lYWNoKGZ1bmN0aW9uKGksIG5hdikge1xuXHRcdHZhciBtb2RhbCA9ICQobmF2KS5jbG9zZXN0KCcubW9kYWwnKTtcblxuXHRcdCQobW9kYWwpLmFwcGVuZChuYXYpO1xuXHR9KVxuXG5cdCQoJ1tkYXRhLW9wZW5dJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHZhciBtID0gJCh0aGlzKS5kYXRhKCdvcGVuJyksXG5cdFx0XHRcdG1vZGFsID0gJCgnW2RhdGEtbW9kYWw9XCInK20rJ1wiXScpLFxuXHRcdFx0XHRnYWxsZXJ5ID0gJCh0aGlzKS5jbG9zZXN0KCcuZ2FsbGVyeScpO1xuXG5cdFx0Ly8g0L/RgNC10LLRjNGOXG5cblx0XHRpZiAobSA9PT0gJ3ZpZXcnKSB7XG5cdFx0XHR2YXIgaW1nID0gJCh0aGlzKS5maW5kKCdpbWcnKS5jbG9uZSgpO1xuXG5cdFx0XHQkKG1vZGFsKS5maW5kKCcubW9kYWxfX2dhbGxlcnknKS5odG1sKGltZyk7XG5cdFx0XHQkKCcuZ2FsbGVyeV9fdmlldycpLmFkZENsYXNzKCdoaWRkZW4nKTtcblxuXHRcdFx0JCgnLm1vZGFsX19uYXYgLmFycm93Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0dmFyIGFjdGl2ZSA9ICQoZ2FsbGVyeSkuZmluZCgnLmFjdGl2ZScpO1xuXG5cdFx0XHRcdGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhcnJvd19wcmV2JykpIHtcblx0XHRcdFx0XHR2YXIgcHJldiA9ICQoYWN0aXZlKS5wcmV2KCkuZ2V0KDApO1xuXG5cdFx0XHRcdFx0aWYgKCFwcmV2KSB7XG5cdFx0XHRcdFx0XHRwcmV2ID0gJChnYWxsZXJ5KS5maW5kKCcuZ2FsbGVyeV9faXRlbXMnKS5jaGlsZHJlbigpLmxhc3QoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQkKGFjdGl2ZSkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdCQocHJldikudHJpZ2dlcignY2xpY2snKTtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBuZXh0ID0gJChhY3RpdmUpLm5leHQoKS5nZXQoMCk7XG5cblx0XHRcdFx0XHRpZiAoIW5leHQpIHtcblx0XHRcdFx0XHRcdG5leHQgPSAkKGdhbGxlcnkpLmZpbmQoJy5nYWxsZXJ5X19pdGVtcycpLmNoaWxkcmVuKCkuZmlyc3QoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQkKGFjdGl2ZSkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdCQobmV4dCkudHJpZ2dlcignY2xpY2snKTtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9XG5cblx0XHQkKG1vZGFsKS5pemlNb2RhbCgnb3BlbicpO1xuXG5cdFx0JChkb2N1bWVudCkub24oJ2Nsb3NlZCcsICdbZGF0YS1tb2RhbF0nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAkKCcuZ2FsbGVyeV9fdmlldy5oaWRkZW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cdFx0XHRcdCQoJy5tb2RhbF9fbmF2IC5hcnJvdycpLm9mZigpO1xuICAgIH0pO1xuXG5cblx0fSlcblxuXHQvLyDQodC10YLQutCwXG5cblx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHQkKCcuZ3JpZCcpLm1hc29ucnkoe1xuXHRcdFx0aXRlbVNlbGVjdG9yOiAnLmdyaWRfX2l0ZW0nLFxuXHRcdFx0Z3V0dGVyOiAxOSxcblx0XHRcdGhvcml6b250YWxPcmRlcjogdHJ1ZVxuXHRcdH0pO1xuXHR9LCAxMDApXG5cblx0Ly8gbG9va2Jvb2tcblxuXHRmdW5jdGlvbiBsa0FjdGl2ZShwb2ludCkge1xuXHRcdHZhciBkYXRhID0gJChwb2ludCkuZGF0YSgnaXRlbScpLFxuXHRcdFx0XHRjYXJkID0gJChwb2ludCkuY2xvc2VzdCgnLmxvb2tib29rJykuZmluZCgnLmxvb2tib29rX19saXN0IC5jYXJkW2RhdGEtaXRlbT1cIicrZGF0YSsnXCJdJyk7XG5cblx0XHQkKHBvaW50KS5zaWJsaW5ncygnLnBvaW50JykuYWRkQ2xhc3MoJ3BvaW50X2Rpc2FibGUnKTtcblx0XHQkKGNhcmQpLnJlbW92ZUNsYXNzKCdjYXJkX2Rpc2FibGUnKTtcblx0XHQkKGNhcmQpLnNpYmxpbmdzKCkuYWRkQ2xhc3MoJ2NhcmRfZGlzYWJsZScpO1xuXHR9XG5cblx0ZnVuY3Rpb24gbGtEaXNhYmxlKHBvaW50KSB7XG5cdFx0JChwb2ludCkuc2libGluZ3MoKS5yZW1vdmVDbGFzcygncG9pbnRfZGlzYWJsZScpO1xuXHRcdCQocG9pbnQpLmNsb3Nlc3QoJy5sb29rYm9vaycpLmZpbmQoJy5jYXJkX2Rpc2FibGUnKS5yZW1vdmVDbGFzcygnY2FyZF9kaXNhYmxlJyk7XG5cdH1cblxuXHQkKCcucG9pbnQnKS5ob3ZlcihmdW5jdGlvbigpIHtcblx0XHQkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy5wb2ludF9hY3RpdmUnKS5yZW1vdmVDbGFzcygncG9pbnRfYWN0aXZlJykuc2libGluZ3MoJy5wb2ludF9kaXNhYmxlJykucmVtb3ZlQ2xhc3MoJ3BvaW50X2Rpc2FibGUnKTtcblx0XHRsa0FjdGl2ZSh0aGlzKTtcblx0fSwgZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCQodGhpcykuaGFzQ2xhc3MoJ3BvaW50X2FjdGl2ZScpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGxrRGlzYWJsZSh0aGlzKTtcblx0fSlcblxuXHQkKCcucG9pbnQnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHQkKHRoaXMpLmFkZENsYXNzKCdwb2ludF9hY3RpdmUnKTtcblx0XHRsa0FjdGl2ZSh0aGlzKTtcblx0fSk7XG5cblx0JCgnLmxvb2tib29rX19saXN0IC5jYXJkJykuaG92ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHQkKHRoaXMpLnNpYmxpbmdzKCkuYWRkQ2xhc3MoJ2NhcmRfZGlzYWJsZScpO1xuXHRcdFx0dmFyIGQgPSAkKHRoaXMpLmRhdGEoJ2l0ZW0nKTtcblx0XHRcdCQoJy5wb2ludFtkYXRhLWl0ZW09JytkKyddJykuYWRkQ2xhc3MoJ3BvaW50X2FjdGl2ZScpO1xuXHR9LCBmdW5jdGlvbigpIHtcblx0XHQkKCcubG9va2Jvb2tfX2xpc3QgLmNhcmQnKS5yZW1vdmVDbGFzcygnY2FyZF9kaXNhYmxlJyk7XG5cdFx0JCgnLnBvaW50X2FjdGl2ZScpLnJlbW92ZUNsYXNzKCdwb2ludF9hY3RpdmUnKTtcblx0fSk7XG5cblx0Ly8g0JrQsNGA0YLQvtGH0LrQsCDQsNC00LDQv9GC0LjQslxuXG5cdGZ1bmN0aW9uIGNhcmRBZGFwdGl2ZSgpIHtcblx0XHR2YXIgdyA9ICQod2luZG93KS53aWR0aCgpO1xuXG5cdFx0aWYgKHcgPD0gMTAwMCkge1xuXHRcdFx0aWYgKCEkKCcuaW5mb192ZXJ0aWNhbCcpLmdldCgwKSkge1xuXHRcdFx0XHQkKFwiLmluZm9cIikudW5zdGljaygpLnJlbW92ZUNsYXNzKCdpbmZvX3N0aWNrJyk7XG5cdFx0XHRcdCQoJy5pbmZvJykuaW5zZXJ0QWZ0ZXIoJy5nYWxsZXJ5Jyk7XG5cdFx0XHRcdCQoJy5jLXBhZ2VfX2luZm8nKS5lbXB0eSgpO1xuXHRcdFx0XHQkKCcuaW5mbycpLnJlbW92ZUNsYXNzKCdpbmZvX2hvcml6b250YWwnKS5hZGRDbGFzcygnaW5mb192ZXJ0aWNhbCcpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoISQoJy5pbmZvX2hvcml6b250YWwnKS5nZXQoMCkpIHtcblx0XHRcdFx0JCgnLmMtcGFnZV9faW5mbycpLmFwcGVuZCgkKCcuaW5mbycpKTtcblx0XHRcdFx0JCgnLmluZm8nKS5yZW1vdmVDbGFzcygnaW5mb192ZXJ0aWNhbCcpLmFkZENsYXNzKCdpbmZvX2hvcml6b250YWwnKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRjYXJkQWRhcHRpdmUoKTtcblx0JCh3aW5kb3cpLm9uKCdyZXNpemUnLCBjYXJkQWRhcHRpdmUpO1xuXG5cdC8vINCc0LXQvdGOXG5cblx0JCgnLm1lbnUnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0JCh0aGlzKS5jbG9zZXN0KCcuaGVhZGVyJykudG9nZ2xlQ2xhc3MoJ2hlYWRlcl9zaG93LW1lbnUnKVxuXHR9KVxuXG5cdC8vINCT0L7RgNC+0LRcblxuXHQkKCcuY2l0eV9fY3VycmVudCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHQkKCcuY2l0eScpLnRvZ2dsZUNsYXNzKCdjaXR5X3Nob3cnKTtcblx0fSlcblxuXHQvLyBsb29rYm9vayBlZGl0b3JcblxuXHRmdW5jdGlvbiBnZXRDb29yZHMoZWxlbSkge1xuXHQgIHJldHVybiB7XG5cdCAgICB0b3A6IGVsZW0ub2Zmc2V0VG9wLFxuXHQgICAgbGVmdDogZWxlbS5vZmZzZXRMZWZ0XG5cdCAgfTtcblx0fVxuXG5cdHZhciBwb2ludCA9ICQoJy5wb2ludF9tb3ZlJykuZ2V0KDApLFxuXHRcdFx0YXJlYSA9ICQoJy5sb29rYm9va19fc2V0IGltZycpLFxuXHRcdFx0YXJlYUJvcmRlcnMgPSB7XG5cdFx0XHRcdHRvcDogJChhcmVhKS5oZWlnaHQoKSAtIDI0LFxuXHRcdFx0XHRsZWZ0OiAkKGFyZWEpLndpZHRoKCkgLSAyNFxuXHRcdFx0fTtcblxuXHQkKHBvaW50KS5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHZhciBjb29yZHMgPSBnZXRDb29yZHMocG9pbnQpLFxuXHRcdFx0XHRzaGlmdFggPSBlLnBhZ2VYIC0gY29vcmRzLmxlZnQsXG4gIFx0XHRcdHNoaWZ0WSA9IGUucGFnZVkgLSBjb29yZHMudG9wO1xuXG5cdCAgbW92ZUF0KGUpO1xuXG5cdCAgcG9pbnQuc3R5bGUuekluZGV4ID0gMTAwMDsgLy8g0L3QsNC0INC00YDRg9Cz0LjQvNC4INGN0LvQtdC80LXQvdGC0LDQvNC4XG5cblx0XHRmdW5jdGlvbiBtb3ZlQXQoZSkge1xuXHRcdFx0dmFyIHRvcCA9IGUucGFnZVkgLSBzaGlmdFksXG5cdFx0XHRcdFx0bGVmdCA9IGUucGFnZVggLSBzaGlmdFg7XG5cblx0XHRcdGlmIChsZWZ0ID49IGFyZWFCb3JkZXJzLmxlZnQpIHtcblx0XHRcdFx0bGVmdCA9IGFyZWFCb3JkZXJzLmxlZnRcblx0XHRcdH0gZWxzZSBpZiAobGVmdCA8PSAwKXtcblx0XHRcdFx0bGVmdCA9IDA7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0b3AgPD0gMCkge1xuXHRcdFx0XHR0b3AgPSAwO1xuXHRcdFx0fSBlbHNlIGlmICh0b3AgPj0gYXJlYUJvcmRlcnMudG9wKSB7XG5cdFx0XHRcdHRvcCA9IGFyZWFCb3JkZXJzLnRvcFxuXHRcdFx0fVxuXG5cdCAgICBwb2ludC5zdHlsZS5sZWZ0ID0gbGVmdCArICdweCc7XG5cdCAgICBwb2ludC5zdHlsZS50b3AgPSB0b3AgICsgJ3B4JztcblxuXHRcdFx0JCgnW2RhdGEtY29vcmRzXScpLmVhY2goZnVuY3Rpb24oaSwgZmllbGQpIHtcblx0XHRcdFx0dmFyIGNvb3JkcyA9ICQodGhpcykuZGF0YSgnY29vcmRzJyksXG5cdFx0XHRcdFx0XHRpbnB1dCA9ICQodGhpcykuZmluZCgnaW5wdXQnKTtcblxuXHRcdFx0XHRzd2l0Y2ggKGNvb3Jkcykge1xuXHRcdFx0XHRcdGNhc2UgJ3RvcCc6XG5cdFx0XHRcdFx0XHQkKGlucHV0KS52YWwodG9wKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ2xlZnQnOlxuXHRcdFx0XHRcdFx0JChpbnB1dCkudmFsKGxlZnQpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHQgIH1cblxuXHRcdGRvY3VtZW50Lm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24oZSkge1xuXHQgICAgbW92ZUF0KGUpO1xuXHQgIH07XG5cblx0ICBwb2ludC5vbm1vdXNldXAgPSBmdW5jdGlvbigpIHtcblx0ICAgIGRvY3VtZW50Lm9ubW91c2Vtb3ZlID0gbnVsbDtcblx0ICAgIHBvaW50Lm9ubW91c2V1cCA9IG51bGw7XG5cdCAgfTtcblxuXHRcdHBvaW50Lm9uZHJhZ3N0YXJ0ID0gZnVuY3Rpb24oKSB7XG5cdFx0ICByZXR1cm4gZmFsc2U7XG5cdFx0fTtcblx0fSlcblxuXHQvLyDQmNC90YTQviDQsiDQutCw0YDRgtC+0YfQutC1XG5cblx0ZnVuY3Rpb24gaW5mb1N0aWNrKCkge1xuXHRcdGlmICgkKHdpbmRvdykud2lkdGgoKSA+IDEwMDApIHtcblx0XHRcdGlmICgkKCcuaW5mbycpLmhhc0NsYXNzKCdpbmZvX3N0aWNrJykpIHtcblx0XHRcdFx0JCgnLmluZm8nKS5zdGlja3koJ3VwZGF0ZScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0JCgnLmluZm8nKS5zdGlja3koe1xuXHRcdFx0XHRcdHRvcFNwYWNpbmc6IDIwLFxuXHRcdFx0XHRcdGJvdHRvbVNwYWNpbmc6ICQoJy5wYWdlX193cmFwcGVyJykuaGVpZ2h0KCkgLSAkKCcuYy1wYWdlX19tYWluJykuaGVpZ2h0KCkgKyAkKCcuZm9vdGVyJykuaGVpZ2h0KClcblx0XHRcdFx0fSkuYWRkQ2xhc3MoJ2luZm9fc3RpY2snKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGluZm9TdGljayk7XG5cdGluZm9TdGljaygpO1xuXG5cdCQoJy5jLXBhZ2UgLnRhYnMgbGknKS5vbignY2xpY2snLCBpbmZvU3RpY2spO1xuXG5cblx0JCgnLmxrX19pdGVtJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0JCgnLmxvb2tib29rX19zZXQnKS5zdGlja3koKVxuXHR9KTtcblxuXHQkKCcucGFnZV9fc2lkZS1uYXYnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHQkKHRoaXMpLm5leHQoJy5zaWRlbmF2JykudG9nZ2xlKCk7XG5cdH0pXG5cblxufSkod2luZG93KTtcbiJdfQ==
